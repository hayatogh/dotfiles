set -g @fore     'fg=#63aed9'
# set -g @rev      'bg=#63aed9,fg=black'
# set -g @rev      'bg=#f9aec8,fg=black'
set -g @rev      'bg=#ffe673,fg=black'
set -g @darkblue 'bg=#1a5fb4'
set -g @purple   'bg=#864290'
set -g @yellow   'bg=#ffc547,fg=black'
# server
set -g escape-time 5
set -g set-clipboard on
# session
set -g bell-action other
set -g menu-selected-style '#{@rev}'
set -g message-style '#{@darkblue}'
set -g mouse on
set -g prefix C-j
set -g renumber-windows on
set -g status-interval 1
set -g status-keys emacs
set -g status-left '#{?#{==:#{session_name},0},,[#{session_name}] }'
set -g status-right ''
set -g status-style bg=black
set -g visual-activity on
set -g visual-bell on
set -g visual-silence on
# window
set -g automatic-rename-format '#{?#{==:#{pane_current_command},bash},,#{pane_current_command}}'
set -g copy-mode-match-style '#{@yellow}'
set -g copy-mode-current-match-style '#{@purple}'
set -g mode-keys vi
set -g mode-style '#{@rev}'
set -g pane-active-border-style '#{@fore}'
set -g window-status-current-format '#I#{?window_flags,#{window_flags},} #W'
set -g window-status-current-style '#{@rev}'
set -g window-status-format '#I#{?window_flags,#{window_flags},} #W'
set -g wrap-search off
# pane
set -g allow-passthrough on
set -g allow-rename on

bind -n M-e    neww
bind -n M-n    selectw -n
bind -n M-p    selectw -p
bind -n M-z    selectw -T
bind -n M-0    selectw -t0
bind -n M-1    selectw -t1
bind -n M-2    selectw -t2
bind -n M-3    selectw -t3
bind -n M-4    selectw -t4
bind -n M-5    selectw -t5
bind -n M-6    selectw -t6
bind -n M-7    selectw -t7
bind -n M-8    selectw -t8
bind -n M-9    selectw -t9
bind -n PageUp { copy-mode -u ; send -X start-of-line }

unbind C-b
bind C-v   send-prefix
bind e     neww
bind C-e   neww
bind E     neww -c'#{pane_current_path}'
bind s     splitw
bind v     splitw -h
bind S     splitw -c'#{pane_current_path}'
bind V     splitw -hc'#{pane_current_path}'
bind C-d   detach
bind C-n   selectw -n
bind C-p   selectw -p
bind h     selectp -L
bind j     selectp -D
bind k     selectp -U
bind l     selectp -R
bind C-]   pasteb -p
bind C-j   pasteb -p
bind C-k   pasteb
set -s command-alias[100] copymode2='
	copy-mode
	if "[ #{cursor_x} -ge $(tmux capturep -p -S#{cursor_y} -E#{cursor_y} | wc -L) ]" {
		send -X end-of-line
		send -X cursor-left
	}
'
bind Space copymode2
bind C-@   copymode2
bind H     swapw -dt-1
bind L     swapw -dt+1
bind C     attach -c'#{pane_current_path}'

bind -Tcopy-mode-vi Space {
	if -F '#{selection_active}' {
		send -X copy-selection-and-cancel
	} {
		send -X begin-selection
	}
}
bind -Tcopy-mode-vi Escape {
	if -F '#{selection_active}' {
		send -X clear-selection
	} {
		send -X cancel
	}
}
bind -Tcopy-mode-vi y send -X copy-selection
set -s command-alias[101] eol2='send -X end-of-line; send -X cursor-left'
bind -Tcopy-mode-vi $ eol2
bind -Tcopy-mode-vi End eol2
# append
bind -Tcopy-mode-vi a {
	set -F @bufn '#{buffer_name}'
	send -X copy-selection
	run 'tmux setb "$(tmux showb -b#{@bufn})$(tmux showb)"'
}
bind -Tcopy-mode-vi A {
	set -F @bufn '#{buffer_name}'
	send -X copy-selection-and-cancel
	run 'tmux setb "$(tmux showb -b#{@bufn})$(tmux showb)"'
}
# trim newline
bind -Tcopy-mode-vi Y {
	send -X copy-end-of-line-and-cancel
	run 'tmux setb "$(tmux showb)"'
}

# mouse event
# common:       MouseDown1Pane MouseUp1Pane SecondClick1Pane
# double click: MouseUp1Pane DoubleClick1Pane
#   w/ long second:
#               DoubleClick1Pane MouseUp1Pane
# triple click: MouseUp1Pane TripleClick1Pane MouseUp1Pane
# drag:         MouseDrag1Pane MouseDragEnd1Pane
bind -n SecondClick1Pane {
	if -F '#{||:#{pane_in_mode},#{mouse_any_flag}}' { } {
		copy-mode -H
		send -X select-word
		set -g @lastclick 'second'
	}
}
bind -Tcopy-mode-vi MouseUp1Pane {
	if -F '#{==:#{@lastclick},second}' {
		set -g @lastclick ''
	} {
		send -X copy-pipe-and-cancel
	}
}
bind -Tcopy-mode-vi DoubleClick1Pane {
	if -F '#{==:#{@lastclick},second}' {
		set -g @lastclick 'double'
	} {
		send -X copy-pipe-and-cancel
	}
}
bind -Tcopy-mode-vi TripleClick1Pane {
	send -X select-line
}

if '[ -r ~/.localtmux.conf ]' {
	source ~/.localtmux.conf
}
